<!DOCTYPE html>
<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
		<link rel="icon" href="design/icon.jpg"/>
  		<link rel="stylesheet" href="style/design.css"/>
		<script type="text/javascript" src="https://code.jquery.com/jquery-3.1.1.slim.min.js"></script>
		<script type="text/javascript">
			function page() {
				// on envoie la requête XML
				var xhr = new XMLHttpRequest();
				xhr.onload = function() {
					if (xhr.status === 200) {
						var xmlDoc = xhr.responseXML;
						var text = xmlDoc.getElementsByTagName("indent");
						var data = xmlDoc.getElementsByTagName("article");
						var metadata = document.getElementById("articles");
						metadata.innerHTML = "";
						// on calcul le nombre de données
						for (var i = 0; i < data.length; i++) {
							var article, media, title, date, indentation, line, x, y/*, z*/;
							article = document.createElement("article");
							metadata.appendChild(article);
							media = document.createElement("img");
							media.setAttribute("src", "medias/"+data[i].getAttribute("no")+"/media.jpg");
							article.appendChild(media);
							/*z = document.createElement("form");
							z.setAttribute("action", "article.html");
							article.appendChild(z);*/
							x = document.createElement("button");
							x.setAttribute("name", "no");
							x.setAttribute("value", data[i].getAttribute("no"));
							article.appendChild(x);
							/*z.appendChild(x);*/
							title = document.createElement("h3");
							title.appendChild(document.createTextNode(getNodeValue(data[i], "title")));
							x.appendChild(title);
							date = document.createElement("h4");
							date.appendChild(document.createTextNode(getNodeValue(data[i], "date")));
							article.appendChild(date);
							var y = "", j;
							for (var j = 0; j < text.length; j++) {
								y += "<"+text[j].getAttribute("semantic")+">"+text[j].textContent+"</"+text[j].getAttribute("semantic")+">";
							}
							indentation = document.createElement("div");
							indentation.innerHTML = y;
							article.appendChild(indentation);
							line = document.createElement("hr");
							article.appendChild(line);
						}
						function getNodeValue(obj, tag) {
							return obj.getElementsByTagName(tag)[0].firstChild.nodeValue;
						}
					}
				};
				// on charge le contenu du document
				xhr.open("GET", "articles.xml", true);
				xhr.send(null);
			}
		</script>
	</head>
	<body onload="page()">
		<header><div><h1>Of Stories<br/>and Trees</h1><h2>In search of wisdom and discernment</h2><ul><li onclick="window.location.href='#articles';">blog</li><li onclick="window.location.href='https://www.alltrails.com/members/patrick-chartrand-4/maps';">custom maps</li></ul></div></header>
		<main id="articles"><!-- Document Object Model Contents --></main>
		<footer><h5><a href="mailto:patrick.chartrand@umontreal.ca">Patrick Chartrand</a> &copy; 2021</h5></footer>
	</body>
</html>
